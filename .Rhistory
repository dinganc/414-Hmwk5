for (i in colnames(df)){
if (i=='y'){next}
if (sapply(df[i], is.factor)==TRUE){next}
{df[i]=(df[i]-min(df[i]))/(max(df[i])-min(df[i]))}
}
df=as.data.frame(model.matrix(~.-1,data=df))
na.omit(df)
View(df)
knitr::opts_chunk$set(echo = TRUE)
#Insert your code for data import and cleaning here
df = read.table('telemarketing.csv',sep=';',header=T)
dia.map = c("no"=0, "yes"=1)
df$y=dia.map[as.character(df$y)]
df$duration=NULL
for (i in colnames(df)){
if (i=='y'){next}
if (sapply(df[i], is.factor)==TRUE){next}
{df[i]=(df[i]-mean(df[i]))/sd(df[i])}
}
#Insert your code for data import and cleaning here
df = read.table('telemarketing.csv',sep=';',header=T)
dia.map = c("no"=0, "yes"=1)
df$y=dia.map[as.character(df$y)]
df$duration=NULL
for (i in colnames(df)){
if (i=='y'){next}
if (sapply(df[i], is.factor)==TRUE){next}
{df[i]=(df[i]-min(df[i]))/(max(df[i])-min(df[i]))}
}
df=as.data.frame(model.matrix(~.-1,data=df))
na.omit(df)
#Insert your code for data import and cleaning here
df = read.table('telemarketing.csv',sep=';',header=T)
dia.map = c("no"=0, "yes"=1)
df$y=dia.map[as.character(df$y)]
df$duration=NULL
for (i in colnames(df)){
if (i=='y'){next}
if (sapply(df[i], is.factor)==TRUE){next}
{df[i]=(df[i]-mean(df[i]))/(max(df[i])-min(df[i]))}
}
df=as.data.frame(model.matrix(~.-1,data=df))
na.omit(df)
#Insert your code for data import and cleaning here
df = read.table('telemarketing.csv',sep=';',header=T)
dia.map = c("no"=0, "yes"=1)
df$y=dia.map[as.character(df$y)]
df$duration=NULL
for (i in colnames(df)){
if (i=='y'){next}
if (sapply(df[i], is.factor)==TRUE){next}
{df[i]=(df[i]-mean(df[i]))/(sd(df[i])-min(df[i]))}
}
#Insert your code for data import and cleaning here
df = read.table('telemarketing.csv',sep=';',header=T)
dia.map = c("no"=0, "yes"=1)
df$y=dia.map[as.character(df$y)]
df$duration=NULL
for (i in colnames(df)){
if (i=='y'){next}
if (sapply(df[i], is.factor)==TRUE){next}
{df[i]=scale(df[i])}
}
df=as.data.frame(model.matrix(~.-1,data=df))
na.omit(df)
knitr::opts_chunk$set(echo = TRUE)
#Insert your code for data import and cleaning here
df = read.table('telemarketing.csv',sep=';',header=T)
dia.map = c("no"=0, "yes"=1)
df$y=dia.map[as.character(df$y)]
df$duration=NULL
for (i in colnames(df)){
if (i=='y'){next}
if (sapply(df[i], is.factor)==TRUE){next}
{df[i]=scale(df[i])}
}
df=as.data.frame(model.matrix(~.-1,data=df))
na.omit(df)
set.seed(2387)
train_ix=sample(seq_len(nrow(df)),size=floor(0.75*nrow(df)))
train=df[train_ix,]
test=df[-train_ix,]
train_labels=train[,'y']
test_labels=test[,'y']
library(class)
knn_mo <- knn(train = train, test = test,
cl = train_labels, k=21)
library(gmodels)
CrossTable(x = test_labels, y = knn_mo,
prop.chisq=FALSE)
knitr::opts_chunk$set(echo = TRUE)
#Insert your code for data import and cleaning here
df = read.table('telemarketing.csv',sep=';',header=T)
dia.map = c("no"=0, "yes"=1)
df$y=dia.map[as.character(df$y)]
df$duration=NULL
library(lmtest)
library(aod)
mo=glm(y~age+job+material+education+default+housing+loan+contact+month+day_of_week+campaign+pdays+previous+poutcome+emp.var.rate+cons.price.idx+cons.conf.idx+euribor3m+nr.employed,data=train,family = 'binomial')
library(lmtest)
library(aod)
mo=glm(y~age+job+material+education+default+housing+loan+contact+month+day_of_week+campaign+pdays+previous+poutcome+emp.var.rate+cons.price.idx+cons.conf.idx+euribor3m+nr.employed,data=df,family = 'binomial')
library(lmtest)
library(aod)
mo=glm(y~age+job+material+education+default+housing+loan+contact+month+day_of_week+campaign+pdays+previous+poutcome+emp.var.rate+cons.price.idx+cons.conf.idx+euribor3m+nr.employed,data=df,family = 'binomial')
library(lmtest)
library(aod)
mo=glm(y~age+job+material+education+default+housing+loan+contact+month+day_of_week+campaign+pdays+previous+poutcome+emp.var.rate+cons.price.idx+cons.conf.idx+euribor3m+nr.employed,data=df,family = 'binomial')
library(lmtest)
library(aod)
mo=glm(y~age+job+marital+education+default+housing+loan+contact+month+day_of_week+campaign+pdays+previous+poutcome+emp.var.rate+cons.price.idx+cons.conf.idx+euribor3m+nr.employed,data=df,family = 'binomial')
summary(mo)
df$marital=NULL
df$education=NULL
df$housing=NULL
df$loan=NULL
for (i in colnames(df)){
if (i=='y'){next}
if (sapply(df[i], is.factor)==TRUE){next}
{df[i]=scale(df[i])}
}
df=as.data.frame(model.matrix(~.-1,data=df))
na.omit(df)
knitr::opts_chunk$set(echo = TRUE)
#Insert your code for data import and cleaning here
df = read.table('telemarketing.csv',sep=';',header=T)
dia.map = c("no"=0, "yes"=1)
df$y=dia.map[as.character(df$y)]
df$duration=NULL
library(lmtest)
library(aod)
mo=glm(y~age+job+marital+education+default+housing+loan+contact+month+day_of_week+campaign+pdays+previous+poutcome+emp.var.rate+cons.price.idx+cons.conf.idx+euribor3m+nr.employed,data=df,family = 'binomial')
summary(mo)
df$marital=NULL
df$education=NULL
df$housing=NULL
df$loan=NULL
for (i in colnames(df)){
if (i=='y'){next}
if (sapply(df[i], is.factor)==TRUE){next}
{df[i]=scale(df[i])}
}
df=as.data.frame(model.matrix(~.-1,data=df))
na.omit(df)
set.seed(2387)
train_ix=sample(seq_len(nrow(df)),size=floor(0.75*nrow(df)))
train=df[train_ix,]
test=df[-train_ix,]
train_labels=train[,'y']
test_labels=test[,'y']
library(class)
knn_mo <- knn(train = train, test = test,
cl = train_labels, k=21)
library(gmodels)
CrossTable(x = test_labels, y = knn_mo,
prop.chisq=FALSE)
knitr::opts_chunk$set(echo = TRUE)
teledata <- read.csv("telemarketing.csv", sep = ";")
teledata$y <- ifelse(teledata$y )
knitr::opts_chunk$set(echo = TRUE)
teledata <- read.csv("telemarketing.csv", sep = ";")
teledata$y <- ifelse(teledata$y )
knitr::opts_chunk$set(echo = TRUE)
teledata <- read.csv("telemarketing.csv", sep = ";")
teledata$y <- ifelse(teledata$y )
knitr::opts_chunk$set(echo = TRUE)
teledata <- read.csv("telemarketing.csv", sep = ";")
str(teledata)
str(telemarketing)
knitr::opts_chunk$set(echo = TRUE)
teledata <- read.csv("telemarketing.csv", sep = ";")
str(teledata)
as.data.frame(model.matrix(~,-1, data = telemarketing))
knitr::opts_chunk$set(echo = TRUE)
teledata <- read.csv("telemarketing.csv", sep = ";")
str(teledata)
```{r results="hide"}
knitr::opts_chunk$set(echo = TRUE)
#Insert your code for data import and cleaning here
df = read.table('telemarketing.csv',sep=';',header=T)
dia.map = c("no"=0, "yes"=1)
df$y=dia.map[as.character(df$y)]
df$duration=NULL
library(lmtest)
library(aod)
mo=glm(y~age+job+marital+education+default+housing+loan+contact+month+day_of_week+campaign+pdays+previous+poutcome+emp.var.rate+cons.price.idx+cons.conf.idx+euribor3m+nr.employed,data=df,family = 'binomial')
summary(mo)
df$marital=NULL
df$education=NULL
df$housing=NULL
df$loan=NULL
for (i in colnames(df)){
if (i=='y'){next}
if (sapply(df[i], is.factor)==TRUE){next}
{df[i]=scale(df[i])}
}
df=as.data.frame(model.matrix(~.-1,data=df))
df$jobbluecollar=df$`jobblue-collar`
df$jobselfemployed=df$`jobself-employed`
df$`jobblue-collar`=NULL
df$`jobself-employed`=NULL
na.omit(df)
set.seed(2387)
train_ix=sample(seq_len(nrow(df)),size=floor(0.75*nrow(df)))
train=df[train_ix,]
test=df[-train_ix,]
train_nn=train
test_nn=test
train_labels=train[,'y']
test_labels=test[,'y']
train$y=NULL
test$y=NULL
library(class)
knn_mo <- knn(train = train, test = test,
cl = train_labels, k=21)
library(gmodels)
CrossTable(x = test_labels, y = knn_mo,
prop.chisq=FALSE)
library(neuralnet)
print(colnames(train_nn))
f <- reformulate(setdiff(colnames(train_nn), "y"), response="y")
model=neuralnet(f,data=train_nn,hidden=c(30),stepmax=1e6,threshold = 0.9,lifesign = 'full')
library(neuralnet)
print(colnames(train_nn))
f <- reformulate(setdiff(colnames(train_nn), "y"), response="y")
model=neuralnet(f,data=train_nn,hidden=c(5,2),stepmax=1e6,threshold = 0.9,lifesign = 'full')
plot(model)
knitr::opts_chunk$set(echo = TRUE)
#Insert your code for data import and cleaning here
df = read.table('telemarketing.csv',sep=';',header=T)
dia.map = c("no"=0, "yes"=1)
df$y=dia.map[as.character(df$y)]
df$duration=NULL
library(lmtest)
library(aod)
mo=glm(y~age+job+marital+education+default+housing+loan+contact+month+day_of_week+campaign+pdays+previous+poutcome+emp.var.rate+cons.price.idx+cons.conf.idx+euribor3m+nr.employed,data=df,family = 'binomial')
summary(mo)
df$marital=NULL
df$education=NULL
df$housing=NULL
df$loan=NULL
for (i in colnames(df)){
if (i=='y'){next}
if (sapply(df[i], is.factor)==TRUE){next}
{df[i]=scale(df[i])}
}
df=as.data.frame(model.matrix(~.-1,data=df))
df$jobbluecollar=df$`jobblue-collar`
df$jobselfemployed=df$`jobself-employed`
df$`jobblue-collar`=NULL
df$`jobself-employed`=NULL
na.omit(df)
set.seed(2387)
train_ix=sample(seq_len(nrow(df)),size=floor(0.75*nrow(df)))
train=df[train_ix,]
test=df[-train_ix,]
train_nn=train
test_nn=test
train_labels=factor(train[,'y'])
test_labels=factor(test[,'y'])
train$y=NULL
test$y=NULL
library(class)
KNN_predic <- knn(train = train, test = test, cl = train_labels, k=33)
library(gmodels)
CrossTable(x = test_labels, y = KNN_predic,
prop.chisq=FALSE)
library(neuralnet)
print(colnames(train_nn))
f <- reformulate(setdiff(colnames(train_nn), "y"), response="y")
model=neuralnet(f,data=train_nn,hidden=c(5,2),stepmax=1e6,threshold = 0.9,lifesign = 'full')
plot(model)
model_results <- compute(model, test_nn[,1:39])
ANN_predic_RAW <- model_results$net.result
ANN_predic=ANN_predic_RAW
ANN_predic[ANN_predic_RAW>=0.5]=1
ANN_predic[ANN_predic_RAW<0.5]=0
combo=data.frame(ANN_predic_RAW,ANN_predic,KNN_predic,test_labels)
combo$combo_res <- rep(NA, nrow(combo))
for(i in 1:nrow(combo)) {
print(combo[i,])
if(combo[i,]$KNN_predict==combo[i,]$ANN_predict){combo[i,]$}
View(combo)
combo=data.frame(ANN_predic_RAW,ANN_predic,KNN_predic,test_labels)
combo$combo_res <- rep(NA, nrow(combo))
for(i in 1:nrow(combo)) {
if(combo[i,]$KNN_predict==combo[i,]$ANN_predict){combo[i,]$combo_res=combo[i,]$ANN_predict}
else if(combo[i,]$ANN_predict_RAW<0.3){combo[i,]$combo_res=0}
else if(combo[i,]$ANN_predict_RAW>0.7){combo[i,]$combo_res=1}
else {combo[i,]$combo_res=KNN_predict}
}
combo=data.frame(ANN_predic_RAW,ANN_predic,KNN_predic,test_labels)
na.omit(combo)
combo$combo_res <- rep(NA, nrow(combo))
for(i in 1:nrow(combo)) {
if(combo[i,]$KNN_predict==combo[i,]$ANN_predict){combo[i,]$combo_res=combo[i,]$ANN_predict}
else if(combo[i,]$ANN_predict_RAW<0.3){combo[i,]$combo_res=0}
else if(combo[i,]$ANN_predict_RAW>0.7){combo[i,]$combo_res=1}
else {combo[i,]$combo_res=KNN_predict}
}
combo=data.frame(ANN_predic_RAW,ANN_predic,KNN_predic,test_labels)
na.omit(combo)
combo$combo_res <- rep(NA, nrow(combo))
for(i in 1:nrow(combo)) {
if(combo[i,]$KNN_predict==1&combo[i,]$ANN_predict==1){combo[i,]$combo_res=combo[i,]$ANN_predict}
else if(combo[i,]$KNN_predict==0&combo[i,]$ANN_predict==0){combo[i,]$combo_res=combo[i,]$ANN_predict}
else if(combo[i,]$ANN_predict_RAW<0.3){combo[i,]$combo_res=0}
else if(combo[i,]$ANN_predict_RAW>0.7){combo[i,]$combo_res=1}
else {combo[i,]$combo_res=KNN_predict}
}
combo=data.frame(ANN_predic_RAW,ANN_predic,KNN_predic,test_labels)
na.omit(combo)
combo$combo_res <- rep(NA, nrow(combo))
for(i in 1:nrow(combo)) {
if(combo[i,]$KNN_predict>0.9&combo[i,]$ANN_predict>0.9){combo[i,]$combo_res=combo[i,]$ANN_predict}
else if(combo[i,]$KNN_predict==0&combo[i,]$ANN_predict==0){combo[i,]$combo_res=combo[i,]$ANN_predict}
else if(combo[i,]$ANN_predict_RAW<0.3){combo[i,]$combo_res=0}
else if(combo[i,]$ANN_predict_RAW>0.7){combo[i,]$combo_res=1}
else {combo[i,]$combo_res=KNN_predict}
}
combo=data.frame(ANN_predic_RAW,ANN_predic,KNN_predic,test_labels)
na.omit(combo)
combo$combo_res <- rep(NA, nrow(combo))
for(i in 1:nrow(combo)) {
#if(combo[i,]$KNN_predict==1&combo[i,]$ANN_predict==1){combo[i,]$combo_res=combo[i,]$ANN_predict}
#else if(combo[i,]$ANN_predict_RAW<0.3){combo[i,]$combo_res=0}
if(combo[i,]$ANN_predict_RAW<0.3){combo[i,]$combo_res=0}
else if(combo[i,]$ANN_predict_RAW>0.7){combo[i,]$combo_res=1}
else {combo[i,]$combo_res=KNN_predict}
}
combo=data.frame(ANN_predic_RAW,ANN_predic,KNN_predic,test_labels)
na.omit(combo)
combo$combo_res <- rep(NA, nrow(combo))
for(i in 1:nrow(combo)) {
if(combo[i,1]==combo[i,2]){combo[i,5]=combo[i,1]}
else if(combo[i,]$ANN_predict_RAW<0.3){combo[i,]$combo_res=0}
else if(combo[i,]$ANN_predict_RAW>0.7){combo[i,]$combo_res=1}
else {combo[i,]$combo_res=KNN_predict}
}
combo=data.frame(ANN_predic_RAW,ANN_predic,KNN_predic,test_labels)
na.omit(combo)
combo$combo_res <- rep(NA, nrow(combo))
for(i in 1:nrow(combo)) {
if(combo[i,1]==combo[i,2]){combo[i,5]=combo[i,1]}
else if(combo[i,]$ANN_predict_RAW<0.3){combo[i,]$combo_res=0}
else if(combo[i,]$ANN_predict_RAW>0.7){combo[i,]$combo_res=1}
else {combo[i,]$combo_res=KNN_predict}
}
combo=data.frame(ANN_predic_RAW,ANN_predic,KNN_predic,test_labels)
na.omit(combo)
combo$combo_res <- rep(NA, nrow(combo))
for(i in 1:nrow(combo)) {
if(combo[i,1]==combo[i,2]){combo[i,5]=combo[i,1]}
else if(combo[i,0]<0.3){combo[i,5]=0}
else if(combo[i,0]>0.7){combo[i,5]=1}
else {combo[i,5]=combo[i,2]}
}
combo=data.frame(ANN_predic_RAW,ANN_predic,KNN_predic,test_labels)
na.omit(combo)
combo$combo_res <- rep(NA, nrow(combo))
for(i in 1:nrow(combo))
{
if(combo[i,1]==combo[i,2]){combo[i,5]=combo[i,1]}
#else if(combo[i,0]<0.3){combo[i,5]=0}
#else if(combo[i,0]>0.7){combo[i,5]=1}
else {combo[i,5]=combo[i,2]}
}
View(combo)
combo=data.frame(ANN_predic_RAW,ANN_predic,KNN_predic,test_labels)
na.omit(combo)
combo$combo_res <- rep(NA, nrow(combo))
for(i in 1:nrow(combo))
{
if(combo[i,1]==combo[i,2]){combo[i,5]=combo[i,1]}
if(combo[i,0]<0.3){combo[i,5]=0}
#else if(combo[i,0]>0.7){combo[i,5]=1}
else {combo[i,5]=combo[i,2]}
}
combo=data.frame(ANN_predic_RAW,ANN_predic,KNN_predic,test_labels)
na.omit(combo)
combo$combo_res <- rep(NA, nrow(combo))
for(i in 1:nrow(combo))
{
if(combo[i,1]==combo[i,2]){combo[i,5]=combo[i,1]}
if(combo[i,0]=<0.3){combo[i,5]=0}
combo=data.frame(ANN_predic_RAW,ANN_predic,KNN_predic,test_labels)
na.omit(combo)
combo$combo_res <- rep(NA, nrow(combo))
for(i in 1:nrow(combo))
{
if(combo[i,1]==combo[i,2]){combo[i,5]=combo[i,1]}
if(as.numeric(combo[i,0])<0.3){combo[i,5]=0}
#else if(combo[i,0]>0.7){combo[i,5]=1}
else {combo[i,5]=combo[i,2]}
}
if(combo[i,0]<0.3){combo[i,5]=0}
if(combo[i,0]<0.3){combo[i,5]=combo[i,1]}
0
0
if(combo[i,0]<0.3){combo[i,5]=0}
#else if(combo[i,0]>0.7){combo[i,5]=1}
else {combo[i,5]=combo[i,2]}
if(combo[i,0]<0.3){combo[i,5]=0}
if(combo[i,1]==combo[i,2]){combo[i,5]=combo[i,1]}
if(combo[i,0]<0.3){combo[i,5]=0}
combo=data.frame(ANN_predic_RAW,ANN_predic,KNN_predic,test_labels)
na.omit(combo)
combo$combo_res <- rep(NA, nrow(combo))
for(i in 1:nrow(combo))
{
if(combo[i,1]==combo[i,2]){combo[i,5]=combo[i,1]}
if(combo[i,0]<0.3){
print(combo[i,0])
combo[i,5]=0}
#else if(combo[i,0]>0.7){combo[i,5]=1}
else {combo[i,5]=combo[i,2]}
}
combo=data.frame(ANN_predic_RAW,ANN_predic,KNN_predic,test_labels)
na.omit(combo)
combo$combo_res <- rep(NA, nrow(combo))
for(i in 1:nrow(combo))
{
if(combo[i,1]==combo[i,2]){combo[i,5]=combo[i,1]}
print(combo[i,0])
if(combo[i,0]<0.3){combo[i,5]=0}
#else if(combo[i,0]>0.7){combo[i,5]=1}
else {combo[i,5]=combo[i,2]}
}
combo=data.frame(ANN_predic_RAW,ANN_predic,KNN_predic,test_labels)
na.omit(combo)
combo$combo_res <- rep(NA, nrow(combo))
for(i in 1:nrow(combo))
{
if(combo[i,1]==combo[i,2]){combo[i,5]=combo[i,1]}
print(combo[i,1])
if(combo[i,0]<0.3){combo[i,5]=0}
#else if(combo[i,0]>0.7){combo[i,5]=1}
else {combo[i,5]=combo[i,2]}
}
combo=data.frame(ANN_predic_RAW,ANN_predic,KNN_predic,test_labels)
na.omit(combo)
combo$combo_res <- rep(NA, nrow(combo))
for(i in 1:nrow(combo))
{
if(combo[i,2]==combo[i,3]){combo[i,5]=combo[i,2]}
print(combo[i,1])
if(combo[i,1]<0.3){combo[i,5]=0}
#else if(combo[i,0]>0.7){combo[i,5]=1}
else {combo[i,5]=combo[i,2]}
}
length(combo$test_labels==combo$combo_res)
sum(combo$test_labels==combo$combo_res)
print(combo$test_labels==combo$combo_res)
sum(combo$test_labels==combo$combo_res)/nrow(combo)
combo=data.frame(ANN_predic_RAW,ANN_predic,KNN_predic,test_labels)
na.omit(combo)
combo$combo_res <- rep(NA, nrow(combo))
for(i in 1:nrow(combo))
{
if(combo[i,2]==combo[i,3]){combo[i,5]=combo[i,2]}
if(combo[i,1]<0.3){combo[i,5]=0}
else if(combo[i,1]>0.7){combo[i,5]=1}
else {combo[i,5]=combo[i,3]}
}
sum(combo$test_labels==combo$ANN_predic)/nrow(combo)
sum(combo$test_labels==combo$KNN_predic)/nrow(combo)
sum(combo$test_labels==combo$combo_res)/nrow(combo)
knitr::opts_chunk$set(echo = TRUE)
#Insert your code for data import and cleaning here
df = read.table('telemarketing.csv',sep=';',header=T)
dia.map = c("no"=0, "yes"=1)
df$y=dia.map[as.character(df$y)]
df$duration=NULL
library(lmtest)
library(aod)
mo=glm(y~age+job+marital+education+default+housing+loan+contact+month+day_of_week+campaign+pdays+previous+poutcome+emp.var.rate+cons.price.idx+cons.conf.idx+euribor3m+nr.employed,data=df,family = 'binomial')
summary(mo)
df$marital=NULL
df$education=NULL
df$housing=NULL
df$loan=NULL
for (i in colnames(df)){
if (i=='y'){next}
if (sapply(df[i], is.factor)==TRUE){next}
{df[i]=scale(df[i])}
}
df=as.data.frame(model.matrix(~.-1,data=df))
df$jobbluecollar=df$`jobblue-collar`
df$jobselfemployed=df$`jobself-employed`
df$`jobblue-collar`=NULL
df$`jobself-employed`=NULL
na.omit(df)
set.seed(2387)
train_ix=sample(seq_len(nrow(df)),size=floor(0.75*nrow(df)))
train=df[train_ix,]
test=df[-train_ix,]
train_nn=train
test_nn=test
train_labels=factor(train[,'y'])
test_labels=factor(test[,'y'])
train$y=NULL
test$y=NULL
library(class)
KNN_predic <- knn(train = train, test = test, cl = train_labels, k=33)
library(gmodels)
CrossTable(x = test_labels, y = KNN_predic,
prop.chisq=FALSE)
library(neuralnet)
print(colnames(train_nn))
f <- reformulate(setdiff(colnames(train_nn), "y"), response="y")
model=neuralnet(f,data=train_nn,hidden=c(5,2),stepmax=1e6,threshold = 0.5,lifesign = 'full')
plot(model)
